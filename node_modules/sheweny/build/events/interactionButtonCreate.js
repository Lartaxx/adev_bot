"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const errors_1 = require("../errors");
async function run(client, interaction) {
    try {
        if (!client.collections.buttons)
            return;
        const button = client.collections.buttons.find((value) => value.customId.includes(interaction.customId));
        if (!button)
            return;
        if (button.before)
            await button.before(interaction);
        const inhibitors = client.collections.inhibitors?.filter((i) => i.type.includes("BUTTON") || i.type.includes("ALL"));
        if (inhibitors && inhibitors.size) {
            const sorted = [...inhibitors.values()].sort((a, b) => b.priority - a.priority);
            for (const i of sorted) {
                if (!i.execute(client, interaction))
                    return i.onFailure(client, interaction);
            }
        }
        await button.execute(interaction);
    }
    catch (e) {
        new errors_1.ShewenyError(client, e);
    }
}
exports.default = run;
